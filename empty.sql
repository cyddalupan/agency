-- ----------------------------
--  View definition for `applicants_logs_view`
-- ----------------------------
DROP VIEW IF EXISTS `applicants_logs_view`;
CREATE ALGORITHM=UNDEFINED  SQL SECURITY DEFINER VIEW `applicants_logs_view` AS select `log`.`log_id` AS `log_id`,`log`.`log_applicant` AS `log_applicant`,`log`.`log_employer` AS `log_employer`,`log`.`log_status` AS `log_status`,`log`.`log_country` AS `log_country`,`log`.`log_date` AS `log_date`,`log`.`log_remarks` AS `log_remarks`,`log`.`log_createdby` AS `log_createdby`,`log`.`log_created` AS `log_created`,`c`.`country_id` AS `country_id`,`c`.`country_name` AS `country_name`,`c`.`country_code` AS `country_code`,`c`.`country_abbr` AS `country_abbr`,`e`.`employer_id` AS `employer_id`,`e`.`employer_user` AS `employer_user`,`e`.`employer_source_agency` AS `employer_source_agency`,`e`.`employer_source_agent` AS `employer_source_agent`,`e`.`employer_no` AS `employer_no`,`e`.`employer_name` AS `employer_name`,`e`.`employer_contact_person` AS `employer_contact_person`,`e`.`employer_contact` AS `employer_contact`,`e`.`employer_email` AS `employer_email`,`e`.`employer_address` AS `employer_address`,`e`.`employer_country` AS `employer_country`,`e`.`employer_remarks` AS `employer_remarks`,`u`.`user_id` AS `user_id`,`u`.`user_name` AS `user_name`,`u`.`user_password` AS `user_password`,`u`.`user_fullname` AS `user_fullname`,`u`.`user_email` AS `user_email`,`u`.`user_type` AS `user_type`,`u`.`user_status` AS `user_status`,`u`.`user_updated` AS `user_updated`,`a`.`applicant_id` AS `applicant_id`,`a`.`applicant_first` AS `applicant_first`,`a`.`applicant_middle` AS `applicant_middle`,`a`.`applicant_last` AS `applicant_last`,concat(`a`.`applicant_first`,' ',`a`.`applicant_middle`,' ',`a`.`applicant_last`) AS `applicant_name`,`a`.`applicant_suffix` AS `applicant_suffix`,`a`.`applicant_birthdate` AS `applicant_birthdate`,`a`.`applicant_age` AS `applicant_age`,`a`.`applicant_gender` AS `applicant_gender`,`a`.`applicant_contacts` AS `applicant_contacts`,`a`.`applicant_address` AS `applicant_address`,`a`.`applicant_email` AS `applicant_email`,`a`.`applicant_nationality` AS `applicant_nationality`,`a`.`applicant_civil_status` AS `applicant_civil_status`,`a`.`applicant_religion` AS `applicant_religion`,`a`.`applicant_languages` AS `applicant_languages`,`a`.`applicant_height` AS `applicant_height`,`a`.`applicant_weight` AS `applicant_weight`,`a`.`applicant_position_type` AS `applicant_position_type`,`a`.`applicant_preferred_position` AS `applicant_preferred_position`,`a`.`applicant_expected_salary` AS `applicant_expected_salary`,`a`.`applicant_preferred_country` AS `applicant_preferred_country`,`a`.`applicant_other_skills` AS `applicant_other_skills`,`a`.`applicant_cv` AS `applicant_cv`,`a`.`applicant_photo` AS `applicant_photo`,`a`.`applicant_status` AS `applicant_status`,`a`.`applicant_source` AS `applicant_source`,`a`.`applicant_remarks` AS `applicant_remarks`,`a`.`applicant_date_applied` AS `applicant_date_applied`,`a`.`applicant_employer` AS `applicant_employer`,`a`.`applicant_job` AS `applicant_job`,`a`.`applicant_slug` AS `applicant_slug`,`e`.`employer_slug` AS `employer_slug` from ((((`applicant_log` `log` join `applicant` `a` on((`a`.`applicant_id` = `log`.`log_applicant`))) left join `user` `u` on((`u`.`user_id` = `log`.`log_createdby`))) left join `employer` `e` on((`e`.`employer_id` = `log`.`log_employer`))) left join `country` `c` on((`c`.`country_id` = `log`.`log_country`))) order by `log`.`log_date` desc,`log`.`log_created` desc,`log`.`log_createdby` desc;

-- ----------------------------
--  View definition for `applicant_view`
-- ----------------------------
DROP VIEW IF EXISTS `applicant_view`;
CREATE ALGORITHM=UNDEFINED  SQL SECURITY INVOKER VIEW `applicant_view` AS select `a`.`applicant_id` AS `applicant_id`,`a`.`applicant_first` AS `applicant_first`,`a`.`applicant_middle` AS `applicant_middle`,`a`.`applicant_last` AS `applicant_last`,concat(`a`.`applicant_first`,' ',`a`.`applicant_middle`,' ',`a`.`applicant_last`) AS `applicant_name`,`a`.`applicant_suffix` AS `applicant_suffix`,`a`.`applicant_birthdate` AS `applicant_birthdate`,`a`.`applicant_age` AS `applicant_age`,`a`.`applicant_gender` AS `applicant_gender`,`a`.`applicant_contacts` AS `applicant_contacts`,`a`.`applicant_address` AS `applicant_address`,`a`.`applicant_email` AS `applicant_email`,`a`.`applicant_nationality` AS `applicant_nationality`,`a`.`applicant_civil_status` AS `applicant_civil_status`,`a`.`applicant_religion` AS `applicant_religion`,`a`.`applicant_languages` AS `applicant_languages`,`a`.`applicant_height` AS `applicant_height`,`a`.`applicant_weight` AS `applicant_weight`,`a`.`applicant_position_type` AS `applicant_position_type`,`a`.`applicant_preferred_position` AS `applicant_preferred_position`,`a`.`applicant_expected_salary` AS `applicant_expected_salary`,`a`.`applicant_preferred_country` AS `applicant_preferred_country`,`a`.`applicant_other_skills` AS `applicant_other_skills`,`a`.`applicant_cv` AS `applicant_cv`,`a`.`applicant_photo` AS `applicant_photo`,`a`.`applicant_status` AS `applicant_status`,`a`.`applicant_source` AS `applicant_source`,`a`.`applicant_remarks` AS `applicant_remarks`,`a`.`applicant_date_applied` AS `applicant_date_applied`,`a`.`applicant_createdby` AS `applicant_createdby`,`a`.`applicant_updatedby` AS `applicant_updatedby`,`a`.`applicant_created` AS `applicant_created`,`a`.`applicant_updated` AS `applicant_updated`,`ae`.`education_id` AS `education_id`,`ae`.`education_applicant` AS `education_applicant`,`ae`.`education_mba` AS `education_mba`,`ae`.`education_mba_course` AS `education_mba_course`,`ae`.`education_mba_year` AS `education_mba_year`,`ae`.`education_college` AS `education_college`,`ae`.`education_college_skills` AS `education_college_skills`,`ae`.`education_college_year` AS `education_college_year`,`ae`.`education_others` AS `education_others`,`ae`.`education_others_year` AS `education_others_year`,`ae`.`education_highschool` AS `education_highschool`,`ae`.`education_highschool_year` AS `education_highschool_year`,`ap`.`passport_id` AS `passport_id`,`ap`.`passport_applicant` AS `passport_applicant`,`ap`.`passport_number` AS `passport_number`,`ap`.`passport_expiration` AS `passport_expiration`,`ap`.`passport_visible` AS `passport_visible`,`ac`.`certificate_id` AS `certificate_id`,`ac`.`certificate_applicant` AS `certificate_applicant`,`ac`.`certificate_tesda` AS `certificate_tesda`,`ac`.`certificate_info_sheet` AS `certificate_info_sheet`,`ac`.`certificate_authenticated` AS `certificate_authenticated`,`ac`.`certificate_authenticated_nbi` AS `certificate_authenticated_nbi`,`ac`.`certificate_insurance` AS `certificate_insurance`,`ac`.`certificate_medical_clinic` AS `certificate_medical_clinic`,`ac`.`certificate_medical_exam_date` AS `certificate_medical_exam_date`,`ac`.`certificate_medical_result` AS `certificate_medical_result`,`ac`.`certificate_medical_remarks` AS `certificate_medical_remarks`,`ac`.`certificate_medical_expiration` AS `certificate_medical_expiration`,`ac`.`certificate_pdos` AS `certificate_pdos`,`ac`.`certificate_pt_result` AS `certificate_pt_result`,`ac`.`certificate_pt_result_date` AS `certificate_pt_result_date`,`ac`.`certificate_philhealth` AS `certificate_philhealth`,`ac`.`certificate_m1b` AS `certificate_m1b`,`ar`.`requirement_id` AS `requirement_id`,`ar`.`requirement_applicant` AS `requirement_applicant`,`ar`.`requirement_visa` AS `requirement_visa`,`ar`.`requirement_visa_date` AS `requirement_visa_date`,`ar`.`requirement_visa_release_date` AS `requirement_visa_release_date`,`ar`.`requirement_visa_expiration` AS `requirement_visa_expiration`,`ar`.`requirement_oec_number` AS `requirement_oec_number`,`ar`.`requirement_oec_submission_date` AS `requirement_oec_submission_date`,`ar`.`requirement_oec_release_date` AS `requirement_oec_release_date`,`ar`.`requirement_owwa_certificate` AS `requirement_owwa_certificate`,`ar`.`requirement_owwa_schedule` AS `requirement_owwa_schedule`,`ar`.`requirement_contract` AS `requirement_contract`,`ar`.`requirement_mofa` AS `requirement_mofa`,`ar`.`requirement_job_offer` AS `requirement_job_offer`,`p`.`position_id` AS `position_id`,`p`.`position_name` AS `position_name`,`c`.`country_id` AS `country_id`,`c`.`country_name` AS `country_name`,`c`.`country_code` AS `country_code`,`c`.`country_abbr` AS `country_abbr`,`ra`.`agent_id` AS `agent_id`,`ra`.`agent_first` AS `agent_first`,`ra`.`agent_last` AS `agent_last`,`ar`.`requirement_remarks` AS `requirement_remarks`,`ar`.`requirement_school_records` AS `requirement_school_records`,`ar`.`requirement_coe` AS `requirement_coe`,`ar`.`requirement_picture_status` AS `requirement_picture_status`,`ar`.`requirement_trade_test` AS `requirement_trade_test`,`j`.`job_id` AS `job_id`,`j`.`job_employer` AS `job_employer`,`j`.`job_position` AS `job_position`,`j`.`job_gender` AS `job_gender`,`j`.`job_salary` AS `job_salary`,`j`.`job_total` AS `job_total`,`j`.`job_occupied` AS `job_occupied`,`j`.`job_name` AS `job_name`,`j`.`job_content` AS `job_content`,`j`.`job_status` AS `job_status`,`j`.`job_remarks` AS `job_remarks`,`u`.`user_id` AS `user_id`,`u`.`user_name` AS `user_name`,`u`.`user_password` AS `user_password`,`u`.`user_fullname` AS `user_fullname`,`u`.`user_email` AS `user_email`,`u`.`user_type` AS `user_type`,`u`.`user_status` AS `user_status`,`u`.`user_lastlogin` AS `user_lastlogin`,`a`.`applicant_slug` AS `applicant_slug`,`a`.`applicant_employer` AS `applicant_employer`,`a`.`applicant_job` AS `applicant_job`,`j`.`job_revenue` AS `job_revenue`,`e`.`employer_id` AS `employer_id`,`e`.`employer_user` AS `employer_user`,`e`.`employer_no` AS `employer_no`,`e`.`employer_name` AS `employer_name`,`e`.`employer_remarks` AS `employer_remarks`,`e`.`employer_contact_person` AS `employer_contact_person`,`e`.`employer_contact` AS `employer_contact`,`e`.`employer_email` AS `employer_email`,`e`.`employer_address` AS `employer_address`,`e`.`employer_country` AS `employer_country`,`e`.`employer_source_agency` AS `employer_source_agency`,`e`.`employer_source_agent` AS `employer_source_agent`,`e`.`employer_agency_commission` AS `employer_agency_commission`,`e`.`employer_agent_commission` AS `employer_agent_commission`,`ar`.`requirement_offer_salary` AS `requirement_offer_salary`,`ar`.`requirement_ticket` AS `requirement_ticket`,`ap`.`passport_issue_place` AS `passport_issue_place`,`ap`.`passport_issue` AS `passport_issue`,`a`.`applicant_paid` AS `applicant_paid` from ((((((((((`applicant` `a` left join `applicant_education` `ae` on((`ae`.`education_applicant` = `a`.`applicant_id`))) left join `applicant_passport` `ap` on((`ap`.`passport_applicant` = `a`.`applicant_id`))) left join `applicant_certificate` `ac` on((`ac`.`certificate_applicant` = `a`.`applicant_id`))) left join `applicant_requirement` `ar` on((`ar`.`requirement_applicant` = `a`.`applicant_id`))) left join `position` `p` on((`p`.`position_id` = `a`.`applicant_preferred_position`))) left join `country` `c` on((`c`.`country_id` = `a`.`applicant_preferred_country`))) left join `recruitment_agent` `ra` on((`ra`.`agent_id` = `a`.`applicant_source`))) left join `job` `j` on((`ar`.`requirement_job_offer` = `j`.`job_id`))) left join `user` `u` on((`a`.`applicant_updatedby` = `u`.`user_id`))) left join `employer` `e` on((`a`.`applicant_employer` = `e`.`employer_id`)));

-- ----------------------------
--  View definition for `billing_employer_view`
-- ----------------------------
DROP VIEW IF EXISTS `billing_employer_view`;
CREATE ALGORITHM=UNDEFINED  SQL SECURITY DEFINER VIEW `billing_employer_view` AS select `b`.`bill_id` AS `bill_id`,`b`.`bill_employer` AS `bill_employer`,`b`.`bill_applicant` AS `bill_applicant`,`b`.`bill_amount` AS `bill_amount`,`b`.`bill_employer_cost` AS `bill_employer_cost`,`b`.`bill_applicant_cost` AS `bill_applicant_cost`,`b`.`bill_employer_deposit` AS `bill_employer_deposit`,`b`.`bill_applicant_deposit` AS `bill_applicant_deposit`,`b`.`bill_status` AS `bill_status`,`b`.`bill_remarks` AS `bill_remarks`,`b`.`bill_createdby` AS `bill_createdby`,`b`.`bill_updatedby` AS `bill_updatedby`,`b`.`bill_created` AS `bill_created`,`b`.`bill_updated` AS `bill_updated`,`e`.`employer_id` AS `employer_id`,`e`.`employer_user` AS `employer_user`,`e`.`employer_no` AS `employer_no`,`e`.`employer_name` AS `employer_name`,`e`.`employer_remarks` AS `employer_remarks`,`e`.`employer_contact_person` AS `employer_contact_person`,`e`.`employer_contact` AS `employer_contact`,`e`.`employer_email` AS `employer_email`,`e`.`employer_address` AS `employer_address`,`e`.`employer_country` AS `employer_country`,`e`.`employer_source_agency` AS `employer_source_agency`,`e`.`employer_source_agent` AS `employer_source_agent`,`e`.`employer_agency_commission` AS `employer_agency_commission`,`e`.`employer_agent_commission` AS `employer_agent_commission`,`e`.`employer_agency_commission_from` AS `employer_agency_commission_from`,`e`.`employer_agent_commission_from` AS `employer_agent_commission_from`,`e`.`employer_slug` AS `employer_slug`,`e`.`employer_createdby` AS `employer_createdby`,`e`.`employer_updatedby` AS `employer_updatedby`,`e`.`employer_created` AS `employer_created`,`e`.`employer_updated` AS `employer_updated`,sum(`b`.`bill_employer_cost`) AS `amount`,sum(`b`.`bill_employer_deposit`) AS `debit`,sum((`b`.`bill_employer_cost` - `b`.`bill_employer_deposit`)) AS `credit`,count(`b`.`bill_applicant`) AS `applicants` from (`bill` `b` join `employer` `e` on((`b`.`bill_employer` = `e`.`employer_id`))) group by `b`.`bill_employer`;

-- ----------------------------
--  Procedure definition for `COMPUTE_AGE`
-- ----------------------------
DROP FUNCTION IF EXISTS `COMPUTE_AGE`;
DELIMITER ;;
CREATE  FUNCTION `COMPUTE_AGE`(`birthdate` date) RETURNS int(11)
    DETERMINISTIC
    SQL SECURITY INVOKER
BEGIN
	RETURN TIMESTAMPDIFF(YEAR, birthdate, CURRENT_TIMESTAMP());
END
;;
DELIMITER ;